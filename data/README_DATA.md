# Data release overview

This repository does **not** ship raw EEG recordings. Instead, it contains the
minimal derived artifacts needed to reproduce the figures in the MPFST paper.

## External sources

- **PhysioNet EEG Motor Movement/Imagery Dataset (eegmmidb)** — DOI:
  https://doi.org/10.13026/C28G6P. Download the original EDF files from
  PhysioNet and place them under `physionet.org/files/eegmmidb/1.0.0/`.
- **Dryad laminar LFP dataset (vFLIP/vIPFC)** — DOI:
  https://doi.org/10.5061/dryad.9w0vt4bnp. Place `data.mat` and
  `vFLIP2_testdata.mat` under `data/doi_10_5061_dryad_9w0vt4bnp__v20251104/`.

## Derived artifacts included here

```
data/
  eegmmidb_all_theta_abg_vq035/
    summary_manifest.csv         # 1,526-run PhysioNet sweep
    subject_tail_metrics.csv     # pooled μ̂_A and duration stats

  flip_example1_vlPFC_mpfst/
    jacobian_metrics.json
    meter_and_valve.png
    avalanche_ccdf.png

  vflip2_raw_mpfst/
    jacobian_metrics.json
    meter_and_valve.png
    avalanche_ccdf.png
```

These files are generated by the scripts described in `README.md`:

- `scripts/run_eegmmidb_batch.py` → `eegmmidb_all_theta_abg_vq035/*.csv`
- `scripts/run_full_pipeline.py` → Dryad result folders
- `scripts/pool_avalanche_tails.py` → `subject_tail_metrics.csv`

## Regenerating these files

Below are the exact commands that recreate the shipped artifacts once you have
accepted the PhysioNet/Dryad licenses.

### PhysioNet ds006036 (eegmmidb)

```bash
# 1) Mirror the dataset locally (≈ 3 GB)
bash scripts/download_ds006036.sh

# 2) Run the MPFST pipeline with the paper defaults
python scripts/run_eegmmidb_batch.py \
  --root physionet.org/files/eegmmidb/1.0.0 \
  --out-dir data/eegmmidb_all_theta_abg_vq035 \
  --band beta \
  --latent-bands theta,alpha,beta,gamma \
  --window-sec 10 \
  --step-sec 1 \
  --gate-q1 0.20 \
  --gate-q2 0.60 \
  --valve-quantile 0.35

# 3) Pool avalanche tails per subject
python scripts/pool_avalanche_tails.py data/eegmmidb_all_theta_abg_vq035
```

### Dryad FLIP / vlPFC excerpts

```bash
# 1) Place data.mat + vFLIP2_testdata.mat under data/doi_10_5061_dryad_9w0vt4bnp__v20251104/

# 2) Convert MATLAB structs into NumPy arrays
python scripts/convert_dryad_lfp_to_npy.py \
  --mat data/doi_10_5061_dryad_9w0vt4bnp__v20251104/data.mat \
  --field data.example1_vlPFC_lfp \
  --mode concat \
  --out-npy data/flip_example1_vlPFC_concat.npy

python scripts/convert_dryad_lfp_to_npy.py \
  --mat data/doi_10_5061_dryad_9w0vt4bnp__v20251104/data.mat \
  --field data.example2_7A_lfp \
  --mode concat \
  --out-npy data/flip_example2_7A_concat.npy

python scripts/convert_dryad_lfp_to_npy.py \
  --mat data/doi_10_5061_dryad_9w0vt4bnp__v20251104/vFLIP2_testdata.mat \
  --field raw \
  --mode concat \
  --out-npy data/vflip2_raw.npy

# 3) Run the full pipeline on each excerpt
python scripts/run_full_pipeline.py \
  --eeg-npy data/flip_example1_vlPFC_concat.npy \
  --fs 1000 \
  --channel 0 1 2 3 \
  --output-dir data/flip_example1_vlPFC_mpfst

python scripts/run_full_pipeline.py \
  --eeg-npy data/flip_example2_7A_concat.npy \
  --fs 1000 \
  --output-dir data/flip_example2_7A_mpfst

python scripts/run_full_pipeline.py \
  --eeg-npy data/vflip2_raw.npy \
  --fs 1000 \
  --output-dir data/vflip2_raw_mpfst
```

The resulting folders match the committed PNG/JSON manifests. Delete and
regenerate them at any time with the same commands.
